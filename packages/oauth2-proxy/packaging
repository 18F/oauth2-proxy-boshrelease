set -e # exit immediately if a simple command exits with a non-zero status
set -u # report the usage of uninitialized variables

mkdir -p ${BOSH_INSTALL_TARGET}/src
cp -a . ${BOSH_INSTALL_TARGET}/src

source /var/vcap/packages/golang-1.10-linux/bosh/compile.env
export GOPATH=$BOSH_INSTALL_TARGET
go install github.com/bitly/oauth2_proxy

# Clean up source artifacts
rm -rf ${BOSH_INSTALL_TARGET}/src ${BOSH_INSTALL_TARGET}/pkg
